@import "tailwindcss";
@plugin "@tailwindcss/typography";

/* ===== Tell Tailwind where to find template files ===== */
@source "../../templates/**/*.html";

/* ===== Custom Theme Extensions ===== */
@theme {
  /* Semantic colors referencing CSS variables */
  --color-surface: var(--surface);
  --color-surface-secondary: var(--surface-secondary);
  --color-surface-elevated: var(--surface-elevated);

  --color-foreground: var(--foreground);
  --color-foreground-secondary: var(--foreground-secondary);
  --color-foreground-muted: var(--foreground-muted);
  --color-foreground-on-accent: var(--foreground-on-accent);

  --color-accent: var(--accent);
  --color-accent-hover: var(--accent-hover);
  --color-accent-cyan: var(--accent-cyan);

  --color-success: var(--success);
  --color-danger: var(--danger);
  --color-danger-hover: var(--danger-hover);
  --color-warning: var(--warning);
  --color-border: var(--border);
  --color-user-bubble: var(--user-bubble);
  --color-assistant-bubble: var(--assistant-bubble);

  /* Custom widths */
  --width-sidebar: 400px;
  --width-sidebar-collapsed: 60px;

  /* Custom max-widths */
  --max-width-modal: 400px;
  --max-width-modal-lg: 600px;
  --max-width-modal-xl: 700px;

  /* Custom z-index */
  --z-index-sidebar-backdrop: 40;
  --z-index-sidebar: 50;
  --z-index-modal: 1000;
  --z-index-modal-nested: 1001;

  /* Custom animations */
  --animate-bounce-dot: bounce-dot 1.4s infinite ease-in-out;
  --animate-blink: blink 1.4s infinite;

  @keyframes bounce-dot {
    0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
    30% { transform: translateY(-6px); opacity: 1; }
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }
}

/* ===== DARK THEME (Liminal Salt) - Default ===== */
:root {
  /* Surfaces/Backgrounds */
  --surface: #1a1c1b;
  --surface-secondary: #141615;
  --surface-elevated: #242726;

  /* Text/Foreground */
  --foreground: #e8e4dc;
  --foreground-secondary: #c5c1b8;
  --foreground-muted: #7a7870;
  --foreground-on-accent: #1a1c1b;

  /* Accent colors */
  --accent: #8fac98;
  --accent-hover: #a3bfac;
  --accent-cyan: #7a9e9e;

  /* Status colors */
  --success: #8fac98;
  --danger: #c47a7a;
  --danger-hover: #d48a8a;
  --warning: #c9a86c;

  /* Borders */
  --border: #2e312f;

  /* Message bubbles */
  --user-bubble: #8fac98;
  --assistant-bubble: #242726;
}

/* ===== LIGHT THEME (Liminal Salt) ===== */
[data-theme="light"] {
  /* Surfaces */
  --surface: #f5f2ed;
  --surface-secondary: #ebe7e0;
  --surface-elevated: #fdfcfa;

  /* Text */
  --foreground: #2d2b28;
  --foreground-secondary: #5a5753;
  --foreground-muted: #9a9590;
  --foreground-on-accent: #f5f2ed;

  /* Accents */
  --accent: #5d7a65;
  --accent-hover: #4a6b52;
  --accent-cyan: #4a7a7a;

  /* Status colors */
  --success: #5d7a65;
  --danger: #b85c5c;
  --danger-hover: #a64e4e;
  --warning: #b8923d;

  /* Borders */
  --border: #ddd8d0;

  /* Bubbles */
  --user-bubble: #5d7a65;
  --assistant-bubble: #ebe7e0;
}

/* Fix prose/typography colors in light mode */
[data-theme="light"] .prose {
  --tw-prose-body: #2d2b28;
  --tw-prose-headings: #2d2b28;
  --tw-prose-links: #5d7a65;
  --tw-prose-bold: #2d2b28;
  --tw-prose-code: #2d2b28;
  --tw-prose-quotes: #5a5753;
}

/* Keep light text for user bubbles in light mode */
[data-theme="light"] .bg-user-bubble .prose {
  --tw-prose-body: #f5f2ed;
  --tw-prose-headings: #f5f2ed;
  --tw-prose-links: #ebe7e0;
  --tw-prose-bold: #f5f2ed;
  --tw-prose-code: #f5f2ed;
  --tw-prose-quotes: #ebe7e0;
}

/* ===== Custom Component Classes ===== */
@utility message-tail-user {
  position: relative;
  &::after {
    content: '';
    position: absolute;
    right: 4px;
    bottom: -10px;
    width: 16px;
    height: 12px;
    background: var(--user-bubble);
    border-radius: 0 6px 1px 16px;
  }
}

@utility message-tail-assistant {
  position: relative;
  &::after {
    content: '';
    position: absolute;
    left: 4px;
    bottom: -10px;
    width: 16px;
    height: 12px;
    background: var(--assistant-bubble);
    border-radius: 6px 0 16px 1px;
  }
}

/* Typewriter word reveal */
.typewriter-word {
  opacity: 0;
  transition: opacity 0.1s ease-in;
}

.typewriter-word.shown {
  opacity: 1;
}

/* Styled select/dropdown */
@utility select-styled {
  appearance: none;
  cursor: pointer;
  padding-right: 2.5rem;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
  background-position: right 0.75rem center;
  background-repeat: no-repeat;
  background-size: 1.25rem;
  &:hover {
    border-color: var(--accent-cyan);
  }
}

/* Alpine.js cloak */
[x-cloak] {
  display: none !important;
}
