{% load markdown_extras %}
<div class="message-container assistant my-4 max-w-[80%] w-fit mr-auto">
    <div class="message assistant message-tail-assistant p-3 px-4 rounded-lg bg-assistant-bubble text-foreground">
        {% if assistant_message|slice:":6" == "ERROR:" %}
            <strong class="flex items-center gap-1">{% include 'icons/alert.html' with class='w-4 h-4' %} Error:</strong><br>
            <pre class="bg-surface p-2 rounded overflow-x-auto mt-2">{{ assistant_message|slice:"6:" }}</pre>
        {% else %}
            <div class="prose prose-invert">{{ assistant_message|markdown }}</div>
        {% endif %}
    </div>
    <div class="flex items-center gap-2 mt-3.5 px-1">
        {% if assistant_timestamp %}
        <span class="timestamp text-xs text-foreground-muted text-left" data-utc="{{ assistant_timestamp }}"></span>
        {% endif %}
        <button type="button"
                class="text-foreground-muted hover:text-foreground cursor-pointer"
                onclick="copyMessageToClipboard(this)"
                data-message="{{ assistant_message|escapejs }}"
                title="Copy to clipboard">
            {% include 'icons/copy.html' with class='w-4 h-4' %}
        </button>
    </div>
</div>
